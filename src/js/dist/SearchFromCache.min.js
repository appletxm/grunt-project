var SearchFromCache=function(){this.params={},this.init=function(){},this.showSearchBox=function(a){var b,c,d,e=null;if(a)for(var f in a)this.params[f]=a[f];c=this.params.pageJSObjName,d=this.params.pageJSObj,b=this.getAddNewItemHtml(),!this.params.popWindow&&this.params.bindObj?this.params.bindObj.innerHTML=b:(c&&d&&d.searchFromCache&&(e=c+".searchFromCache"),this.showPopSearchBox(e,b))},this.showPopSearchBox=function(a,b){var c={buttons:[]};c.needMask=!0,c.title=this.params.title||"",c.space={height:150},c.content=b,c.buttons.push({text:"添 加",css:"save x2",callback:a+".doSaveNewItemName()"},{text:"取 消",css:"cancel x2",callback:a+".cancelNewHospitalCallback()"}),this.params.popWindow.show(c)},this.getAddNewItemHtml=function(){var a="",b=this.params,c=b.pageJSObjName,d=b.pageJSObj,e=null,f=null,g=b.inputLen||100;return c&&d&&d.searchFromCache&&(e=c+".searchFromCache.inputNewName(event);",f=c+".searchFromCache.clearSearch(event);"),a+='<div id="newHospitalPanel" class="user-input-search">',a+="<span>",a+='<i><input id="newHospitalName" oninput="'+e+'" value="" placeholder="'+(b.placeHolder||"")+'" maxlength="'+g+'" size="'+g+'"></i>',a+='<a id="clearKey" class="clear" onclick="'+f+'">x</a>',a+="</span>",a+='<ul id="relativeList"></ul>',a+="</div>"},this.doSaveNewItemName=function(){var a=document.querySelector("#newHospitalName").value,b=this.params.cacheDataList;if(!a||""===a||!a.isNormalText(2,50))return void(this.params.messageBox&&this.params.messageBox.show({msg:this.params.errorMsg,type:"alert",autoClose:!0}));for(var c=0;c<b.length;c++)b[c].name===a&&this.params.selectedTipListCallback(b[c].id);this.params.okCallBack&&this.params.okCallBack(a)},this.inputNewName=function(a){var b=[],c=this.params.cacheDataList,d=a.currentTarget.value||"",e=document.querySelector("#clearKey");d=d.replace(/\s|\n|\b/g,""),d.length>0?e.style.display="block":e.style.display="none";for(var f=0;f<c.length;f++){var g=c[f].name.indexOf(d);g>=0&&b.push(c[f])}this.showTipList(b)},this.showTipList=function(a){var b=document.querySelector("#relativeList"),c=[],d=this.params,e=d.pageJSObjName,f=d.pageJSObj,g=null;e&&f&&f.searchFromCache&&(g=e+".searchFromCache.selectSearchItem(event);");for(var h=0;h<a.length;h++)c.push('<li hId="'+a[h].id+'" onclick="'+g+'">'+a[h].name+"</li>");b.innerHTML=c.join("")},this.selectSearchItem=function(a){var b=a.currentTarget;this.params.selectedTipListCallback&&this.params.selectedTipListCallback(b.getAttribute("hId")),document.querySelector("#newHospitalName").value=b.innerHTML,document.querySelector("#relativeList").innerHTML="",document.querySelector("#clearKey").style.display="block",a.stopPropagation()},this.clearSearch=function(a){a.currentTarget.style.display="none",document.querySelector("#newHospitalName").value="",document.querySelector("#relativeList").innerHTML="",a.stopPropagation()},this.cancelNewHospitalCallback=function(){this.params.popWindow.hide(),this.params.cancelCallBack&&this.params.cancelCallBack()}};