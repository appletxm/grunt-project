"use strict";var mockDepartList={code:0,msg:"成功",data:[{departmentList:[{parentId:1,departName:"肿瘤内科大一",departId:8,secondDepart:[]},{parentId:1,departName:"肿瘤内科大二",departId:9,secondDepart:[{id:90,name:"感染内科一",parentId:9,departName:"肿瘤内科大一",departId:8},{id:91,name:"感染内科二",parentId:9,departName:"肿瘤内科大一",departId:8}]},{parentId:null,departName:"很长的一个科室名称很长很长",departId:6,secondDepart:[]}]}]},myInfoChangeDepartSecond={ajax:null,messageBox:null,popWindow:null,departmentList:[],selectedDepartId:null,parentId:null,parentInfo:{},init:function(){this.ajax=new Ajax,this.messageBox=new MessageBox,this.popWindow=new PopWindow,this.parentId=window.location.search.getValueFromUrl().parentId,this.parentId=parseInt(this.parentId,10),this.attachEvent(),this.getDepartList()},getDepartList:function(){var a={sendParameters:{}};a.url=SYS_VAR.SERVER_ADDRESS+"doc/department_and_title/",a.type="GET",a.asyn=!0,a.onSuccess=this.handleGetLevelSuccess.bind(this),a.onError=this.handleError.bind(this),a.mssage=this.messageBox,this.ajax.send(a)},handleGetLevelSuccess:function(a){var b;0===a.code?(this.departmentList=a.data[0].departmentList,this.orderList(),b=this.getDepartListHtml(this.departmentList),document.querySelector("#depart_list").innerHTML=b):this.handleError(a)},orderList:function(){for(var a,b=this.departmentList,c=0;c<b.length;c++)b[c].departId===this.parentId&&(this.parentInfo.id=b[c].departId,this.parentInfo.name=b[c].departName,a=b[c].secondDepart||[]);if(a&&a.length>0)for(var d=0;d<a.length;d++)a[d].id=a[d].departId,a[d].name=a[d].departName;this.departmentList=a},getDepartListHtml:function(a){var b,c="";b=this.parentInfo.parentId,c+='<a class="selected" href="my-info-change-derpart.html">'+this.parentInfo.name+"</a>",a=a?a:[];for(var d=0;d<a.length;d++){var e,f,g=a[d].secondDepart;!g||g.length<=0?(e='class="check-list no-arrow"',f='onclick="myInfoChangeDepartSecond.selectedDepartment(event)"'):(b=a[d].parentId,e='class=""',f='href="my-info-change-depart-second.html?parentId='+a[d].id+'"'),c+="<a "+f+' parentId="'+b+'" value="'+a[d].id+'" '+e+">"+a[d].name+"</a>"}return c},selectedDepartment:function(a){var b=a.currentTarget,c=b.getAttribute("value");b.getAttribute("parentId");this.toggleChecked(b),this.doSave(c)},doSave:function(a,b){var c={sendParameters:{departmentId:a}};b&&""!==b&&(c.sendParameters.customDepartment=b),c.url=SYS_VAR.SERVER_ADDRESS+"doc/info_update/",c.type="GET",c.asyn=!0,c.onSuccess=this.handleSaveSuccess.bind(this),c.onError=this.handleError.bind(this),c.mssage=this.messageBox,this.ajax.send(c)},toggleChecked:function(a){for(var b=document.querySelectorAll("#depart_list .check-list"),c=0;c<b.length;c++)a===b[c]?b[c].className="check-list no-arrow checked":b[c].className="check-list no-arrow"},handleSaveSuccess:function(a){0===a.code?window.location.href="my-information.html":this.handleError(a)},handleError:function(a){var b=a.msg;b&&""!==b||(b="网络异常，请稍后重试!"),this.messageBox.show({msg:b,type:"alert",autoClose:!0})},attachEvent:function(){}};myInfoChangeDepartSecond.init();