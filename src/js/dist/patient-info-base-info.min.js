"use strict";var mockPatientDetail={data:[{patientId:10,phone:"11111112222",name:"刘德华",remarkName:"隔壁小王",age:30,gender:"男",maritalStatus:"未婚",weight:68,height:186,city:"广东湛江坡头区",smokeHistory:"日吸烟量：平均2支;开始吸烟年龄：18;吸烟状态：吸烟",pastDisease:"过往1,过往6,测试其他",hereditaryDisease:"遗传3,遗传4,测试其他",familyHistory:"父亲：家族2,家族21,家族22,其他病史1;母亲：家族5,家族22,其他病史2;兄弟姐妹：家族11,家族22,其他病史3;子女：家族22,其他病史4;",drinkHstory:"饮酒频率：偶尔;日饮酒量：123两;已戒酒，戒酒年龄2岁;饮酒种类：啤酒,红酒,洋酒,其他酒",medicationAllergy:"过敏7,过敏8,其他过敏",headUrl:""}],msg:"success",code:0},patientBaseInfo={server:SYS_VAR.SERVER_ADDRESS,messageBox:null,ajax:null,requestUrl:SYS_VAR.SERVER_ADDRESS,urlParams:{},patientId:null,init:function(){this.messageBox=new MessageBox,this.ajax=new Ajax,this.showLoading(),this.getParamsFromUrl(),this.getPatientDetail()},getParamsFromUrl:function(){var a=window.location.search;this.urlParams=a.getValueFromUrl(),this.patientId=parseInt(this.urlParams.patient_id,10),this.urlParams=decodeURIComponent(window.localStorage.getItem("patientInfo")),this.urlParams=JSON.parse(this.urlParams),this.setOpenChatButton()},getPatientDetail:function(){var a={sendParameters:{patientId:parseInt(this.urlParams.patient_id,10)}},b="doc/patient_detail/",c=this.handleGetInfoSuccess;this.doRequest(b,a,c)},doRequest:function(a,b,c){var d=b;d.url=this.requestUrl+a,d.type="GET",d.asyn=!0,d.onSuccess=c.bind(this),d.onError=this.handleGetError.bind(this),this.ajax.send(d)},handleGetInfoSuccess:function(a){var b=[],c=document.querySelector("#base-info");if(0===a.code){var d=a.data[0];if(d&&""!==d){var e=";",f=d.smokeHistory.split(e),g=d.drinkHstory.split(e),h=d.familyHistory.split(e),i=d.medicationAllergy.split(e);b.push("<dl><dt>婚姻情况</dt><dd><span>"+(d.maritalStatus||"无")+"</span></dd></dl>"),b.push("<dl><dt>身高</dt><dd><span>"+(d.height||"无")+"</span></dd></dl>"),b.push("<dl><dt>体重</dt><dd><span>"+(d.weight||"无")+"</span></dd></dl>"),b.push("<dl><dt>药物过敏史</dt><dd><span>"+i.join(";<br/>")+"</span></dd></dl>"),b.push("<dl><dt>既往病史</dt><dd><span>"+d.pastDisease+"</span></dd></dl>"),b.push("<dl><dt>家庭病史</dt><dd><span>"+h.join(";<br/>")+"</span></dd></dl>"),b.push("<dl><dt>遗传病史</dt><dd><span>"+(d.hereditaryDisease||"无")+"</span></dd></dl>"),b.push("<dl><dt>吸烟状况</dt><dd><span>"+f.join(";<br/>")+"</span></dd></dl>"),b.push("<dl><dt>饮酒状况</dt><dd><span>"+g.join(";<br/>")+"</span></dd></dl>")}this.hideLoading()}else this.handleGetError(a);c.innerHTML=b.join("")},handleGetError:function(a){var b=a.msg;""!==b&&b||(b="网络异常，请稍后再试"),this.messageBox.show({msg:b,type:"alert",autoClose:!0})},setOpenChatButton:function(){var a=this.urlParams,b="../chat/chat.html",c=document.querySelectorAll("footer")[0];b+="?patient_id="+encodeURIComponent(a.patient_id),b+="&patient_name="+encodeURIComponent(a.patient_name),b+="&patient_icon="+encodeURIComponent(a.patient_icon),b+="&doctor_id="+encodeURIComponent(a.doctor_id),c.innerHTML='<a href="'+b+'">发送消息</a>'},showLoading:function(){this.messageBox.show({msg:'<span class="fa fa-spinner fa-pulse fa-2x fa-fw"></span>',type:"loading",autoClose:!1})},hideLoading:function(){this.messageBox.hide()}};patientBaseInfo.init();