var mock_medicine={data:[{key:"K",voList:[{id:7,name:"克痤隐酮凝胶 安徽安科 6g",commonName:"克痤隐酮凝胶",manufacturer:"xx制药厂",sale:!0,usage:"外用，涂敷患处，一日2次。",image:"http://img.jxdyf.com/product/0000/011/11632_L1.jpg",salePrice:"40.00",marketPrice:"36.00",skus:[{skuId:13888,name:"克痤隐酮凝胶",salePrice:"40.00"}],prescribed:!1},{id:7,name:"克痤隐酮凝胶 安徽安科 6g",commonName:"克痤隐酮凝胶",manufacturer:"xx制药厂",sale:!0,usage:"外用，涂敷患处，一日2次。",image:"http://img.jxdyf.com/product/0000/011/11632_L1.jpg",salePrice:"40.00",marketPrice:"36.00",skus:[{skuId:13888,name:"克痤隐酮凝胶",salePrice:"40.00"}],prescribed:!1}]}],msg:"success",code:0},favoriteMedicine={ajax:null,popWindow:null,messageBox:null,requestUrl:SYS_VAR.SERVER_ADDRESS,mainPageObj:null,deleteMedicine:{},pageInfo:{pageSize:500,pageNo:1},init:function(a){a&&(this.mainPageObj=a.pageObj,this.ajax=a.pageObj.ajax,this.messageBox=a.pageObj.messageBox,this.popWindow=a.pageObj.popWindow),this.attachEvent()},getFavoriteMedicine:function(){var a={sendParameters:{page:this.pageInfo.pageNo,num:this.pageInfo.pageSize}};a.url=this.requestUrl+"doc/medication_box/",a.type="GET",a.asyn=!0,a.onSuccess=this.handleGetFavoriteMedicineSuccess.bind(this),a.onError=this.mainPageObj.handleGetError.bind(this),this.ajax.send(a),this.mainPageObj.showLoading()},handleGetFavoriteMedicineSuccess:function(a){(0===a.code||"0"===a.code)&&this.showFavoriteMedicineList(a.data),this.mainPageObj.hideLoading()},showFavoriteMedicineList:function(a){var b=[],c=document.querySelector("#myFavoriteMedicineList");if(a.length>0)for(var d=0;d<a.length;d++)b=b.concat(a[d].voList);c.innerHTML=this.mainPageObj.getListHtml(b,2)},handleAddOrRemoveStore:function(a,b,c){var d={sendParameters:{pid:a,doctor_id:""}};d.url=this.requestUrl+(c?"doc/medication_add_box/":"doc/medication_remove_box/"),d.type="GET",d.asyn=!0,d.onSuccess=function(a){this.handleAddOrRemoveStoreSuccess(a,b,c)}.bind(this),d.onError=this.mainPageObj.handleGetError.bind(this),this.ajax.send(d),this.mainPageObj.showLoading()},handleAddOrRemoveStoreSuccess:function(a,b,c){var d=b.tagName.toLowerCase();0===a.code?(this.messageBox.show({msg:c?"添加常用药成功":"删除常用药成功",type:"alert",autoClose:!0}),"span"===d&&b.className.indexOf("add-recommond")>=0?this.updateMedicineList(b):b.className=c?"add-store add-store-success":"add-store",this.deleteMedicine={},this.mainPageObj.hideLoading()):(this.mainPageObj.handleGetError(a),this.deleteMedicine={})},handlePanelClick:function(a){var b,c,d=a.target,e=d.tagName.toLowerCase();"h2"===e&&(c=/\d+/.exec(d.querySelectorAll("b")[0].innerHTML),c=c?parseInt(c,10):0,c>0&&(b=d.nextElementSibling.style.display,"none"===b?(d.nextElementSibling.style.display="block",d.className=d.className+" selected"):(d.nextElementSibling.style.display="none",d.className=d.className.replace(" selected",""))),a.preventDefault(),a.stopPropagation())},confirmRemoveMedicine:function(){var a="",b={buttons:[],space:{}};b.needMask=!0,b.title="删除常用药确认",b.space={height:80},a+='<p class="tip-msg-fixed">确认要从常用药品列表删除此药物？</p>',b.content=a,b.buttons.push({text:"确 认",css:"save",callback:"favoriteMedicine.confirmDeleteCallback()"},{text:"取 消",css:"cancel",callback:"favoriteMedicine.cancelDeleteCallback()"}),this.popWindow.show(b)},confirmDeleteCallback:function(){this.handleAddOrRemoveStore(this.deleteMedicine.id,this.deleteMedicine.target,!1),this.popWindow.hide()},cancelDeleteCallback:function(){this.popWindow.hide()},updateMedicineList:function(a){var b=a.parentNode.parentNode;b.parentNode.removeChild(b)},attachEvent:function(){var a=document.querySelector("#myFavoriteMedicineList");a.onclick=function(a){this.handlePanelClick(a)}.bind(this)}},recommend={ajax:null,popWindow:null,messageBox:null,requestUrl:SYS_VAR.SERVER_ADDRESS,recommendList:[],isFromPrescription:null,selectedSpan:null,init:function(a){a&&(this.mainPageObj=a.pageObj,this.ajax=a.pageObj.ajax,this.messageBox=a.pageObj.messageBox,this.popWindow=a.pageObj.popWindow),this.attachEvent()},showRecommendBox:function(a,b){var c,d,e,f,g,h,i,j,k=[],l={buttons:[],space:{}};return this.isFromPrescription=b,c=a.getAttribute("productId")||"",a.className.indexOf("selected")>=0?(a.className="add-recommond",this.doDeleteRecommendItem(c,!0),!1):(a.className="add-recommond selected",this.selectedSpan=a,d=a.getAttribute("skuId")||"",e=decodeURIComponent(a.getAttribute("productName")||""),f=decodeURIComponent(a.getAttribute("commonName")||""),g=decodeURIComponent(a.getAttribute("productSize")||""),h=parseInt(a.getAttribute("hasAddToStore")||0,10),j=decodeURIComponent(a.getAttribute("spec")||""),i=decodeURIComponent(a.getAttribute("usage")||""),l.needMask=!0,l.space={top:10,left:10},k.push('<div class="recommand-tip-box" hasAddToStore="'+h+'" productId="'+c+'" productName="'+(e||"")+'" commonName="'+(f||"")+'" productSize="'+g+'" usage="'+(i||"")+'" skuId="'+d+'">'),f=f&&""!==f?"（"+f+"）":"",k.push("<h1>"+e+f+'<a class="close-pop" onclick="recommend.cancelSelectCallback();"></a></h1>'),k.push('<div class="pro-usage">常规用法：'+i+"</div>"),k.push("<dl>"),k.push("<dt>规格</dt><dd><i>"+j+"</i></dd>"),k.push("</dl>"),k.push("<dl>"),k.push('<dt><span class="red">*</span> 数量</dt>'),k.push("<dd>"),k.push('<span class="number-pick">'),k.push('<input type="button" value="-" onclick="recommend.changeNumber(0, \'medicalNumber\');" />'),k.push('<input id="medicalNumber" oninput="recommend.validateNumber(\'medicalNumber\' ,99);" type="tel" value="1" />'),k.push('<input type="button" value="+" onclick="recommend.changeNumber(1, \'medicalNumber\');" />'),k.push("</span>"),k.push("</dd>"),k.push("</dl>"),k.push("<dl>"),k.push("<dt>一日</dt>"),k.push("<dd>"),k.push('<span class="number-pick">'),k.push('<input type="button" value="-"  onclick="recommend.changeNumber(0, \'timePayDay\');" />'),k.push('<input id="timePayDay" oninput="recommend.validateNumber(\'timePayDay\', 99);" type="tel" value="" />'),k.push('<input type="button" value="+" onclick="recommend.changeNumber(1, \'timePayDay\');" />'),k.push("</span>次"),k.push("</dd>"),k.push("</dl>"),k.push("<dl>"),k.push("<dt>每次</dt>"),k.push('<dd class="">'),k.push('<span class="number-pick">'),k.push('<input type="button" value="-" onclick="recommend.changeNumber(0, \'timePayUnit\');" />'),k.push('<input id="timePayUnit" oninput="recommend.validateNumber(\'timePayUnit\', 99);" type="tel" value="" />'),k.push('<input type="button" value="+" onclick="recommend.changeNumber(1, \'timePayUnit\');" />'),k.push("</span>"),k.push('<span id="unitList" class="unit-list">'),k.push('<input type="hidden" id="unitText" value="片">'),k.push('<a class="selected" forUnit="片" onclick="recommend.chooseUnit(event, \'片\', \'unitText\');">片</a>'),k.push("<i>"),k.push("<a forUnit=\"粒\" onclick=\"recommend.chooseUnit(event, '粒', 'unitText');\">粒</a>"),k.push("<a forUnit=\"包\" onclick=\"recommend.chooseUnit(event, '包', 'unitText');\">包</a>"),k.push("<a forUnit=\"盒\" onclick=\"recommend.chooseUnit(event, '盒', 'unitText');\">盒</a>"),k.push("<a forUnit=\"单位\" onclick=\"recommend.chooseUnit(event, '单位',  'unitText');\">单位</a>"),k.push("</i>"),k.push("</span>"),k.push("</dd>"),k.push("</dl>"),k.push("<dl>"),k.push('<dt>备注</dt><dd><div class="text-outer"><textarea id="backUp" placeholder="以上的用法用量信息，不进行点选，则不会向患者展示。"></textarea></div></dd>'),k.push("</dl>"),k.push('<a class="do-save-recommond" onclick="recommend.confirmSelectCallback(event, recommend.isFromPrescription);">确定</a>'),k.push("</div>"),l.content=k.join(""),void this.showPopWindow(l))},changeNumber:function(a,b,c){var d,e=document.querySelector("#"+b),c=c||99;/^\d+$/.test(e.value)||(e.value=""),d=parseInt(""===e.value?0:e.value,10),0===a?d--:d++,0>=d&&(d="medicalNumber"===b?1:""),d>c&&(d=c),e.value=d},validateNumber:function(a,b){var c,d,e=document.querySelector("#"+a),f="",b=b||99;if(!/^\d+$/.test(e.value))if(d=e.value.match(/\d/g),d&&d.length>=1){for(var g=0;g<d.length;g++)f+=d[g];e.value=f}else"medicalNumber"===a?e.value="1":e.value="";c=parseInt(""===e.value?0:e.value,10),c>b&&(e.value=b)},chooseUnit:function(a,b,c){var d,e;if(a.currentTarget.className.indexOf("selected")<0){e=document.querySelectorAll("#unitList a");for(var f=0;f<e.length;f++)e[f]===a.currentTarget?e[f].className="selected":e[f].className="";d=document.querySelector("#"+c),d.value=b}},confirmSelectCallback:function(a,b){var c,d,e,f,g,h=document.querySelectorAll(".recommand-tip-box")[0],i={};e=h.querySelector("#medicalNumber").value,f=h.querySelector("#timePayDay").value,g=h.querySelector("#timePayUnit").value,f&&""!==f&&"0"!==f||(f=0),g&&""!==g&&"0"!==g||(g=0),i.quantity=e,i.timePayDay=f,i.timePayUnit=g,i.unit=h.querySelector("#unitText").value||"",c=h.getAttribute("productId"),i.bakup=h.querySelector("#backUp").value||"",i.commonName=h.getAttribute("commonName")||"",i.productName=h.getAttribute("productName")||"",i.productId=c,i.skuId=h.getAttribute("skuId"),i.spec="",i.combin="",i.hasAddToStore=parseInt(h.getAttribute("hasAddToStore"),10),this.recommendList.push(i),document.querySelector("#recommandNumber").innerHTML=this.recommendList.length,d=document.querySelectorAll("span.add-recommond");for(var j=0;j<d.length;j++)parseInt(d[j].getAttribute("productId"),10)===parseInt(c,10)&&(d[j].className="add-recommond selected");this.changeRecommendButtonStatus(),this.hidePopWindow(),b&&b.callBack&&b.callBack(),a.preventDefault(),a.stopPropagation()},cancelSelectCallback:function(){this.selectedSpan&&(this.selectedSpan.className="add-recommond"),this.selectedSpan=null,this.hidePopWindow()},checkHasAddedRecommend:function(a){var b='class="ctrl add-recommond"';if(a=parseInt(a,10),this.recommendList.length>0)for(var c=0;c<this.recommendList.length;c++)parseInt(this.recommendList[c].productId,10)===a&&(b='class="ctrl add-recommond selected"');return b},doRecommend:function(){var a={buttons:[],space:{}},b=this.recommendList;return 0===b.length?void this.messageBox.show({msg:"请先添加推荐药",type:"alert",autoClose:!0}):(a.needMask=!0,a.space={height:350,left:20},a.content=this.getRecommendListHtml(b),this.showPopWindow(a),void event.stopPropagation())},getRecommendListHtml:function(a){var b,c,d=[];d.push('<div class="recommand-tip-box recommand-list-box">'),d.push('<h1>用药确认<a class="close-pop" onclick="recommend.cancelDoRecommendCallback();"></a></h1>'),d.push('<div class="list-body" id="recommendListBody">'),d.push("<ul>");for(var e=0;e<a.length;e++)a[e].commonName&&""!==a[e].commonName?(b=a[e].productName+"("+a[e].commonName+")",c=a[0].commonName.substr(0,6)+"的处方单"):(b=a[e].productName,c="处方单"),d.push('<li productId="'+a[e].productId+'">'),d.push("<span>"+b+"</span>"),d.push('<a class="add-recommond selected" onclick="recommend.deleteItemFromList(event, '+a[e].productId+');"></a>'),d.push("</li>");return d.push("</ul>"),d.push('<div id="recommendSaveToPrescription" class="recommend-save-prescription">'),d.push('<span class="checked-outer" onclick="recommend.toggleChecked(event);">'),d.push('<b class="chexk-dot"></b><input type="hidden" value="0" id="savePrescriptionName" />'),d.push('<label for="savePrescriptionName">保存为处方单，下次推荐直接用</label>'),d.push("</span>"),d.push('<span style="display:none;" class="input-name">'),d.push("起个名吧 <em>"),d.push('<input type="text" id="prescriptionName" maxlength="10" size="10" value="'+c+'" />'),d.push("<i>（不超过10个字符）</i>"),d.push("</em>"),d.push("</span>"),d.push("</div>"),d.push("</div>"),d.push('<a class="do-save-recommond" onclick="recommend.confirmDoRecommendCallback();">推荐</a>'),d.push("</div>"),d.join("")},toggleChecked:function(a){var b=a.currentTarget.querySelector("#savePrescriptionName"),c=document.querySelector("#recommendListBody"),d=a.currentTarget.querySelectorAll("b")[0];"0"===b.value?(b.value="1",d.className=d.className+" selected",a.currentTarget.nextElementSibling.style.display="block",c.scrollTop=c.scrollHeight-c.clientHeight):(b.value="0",d.className=d.className.replace(" selected",""),a.currentTarget.nextElementSibling.style.display="none",c.scrollTop=0)},deleteItemFromList:function(a,b){a.target.parentNode.style.display="none",this.doDeleteRecommendItem(b,!0)},doDeleteRecommendItem:function(a,b){for(var c,d=0;d<this.recommendList.length;d++)this.recommendList[d].productId==a&&this.recommendList.splice(d,1);if(document.querySelector("#recommandNumber").innerHTML=this.recommendList.length,this.changeRecommendButtonStatus(),b===!0){c=document.querySelectorAll("span.add-recommond");for(var d=0;d<c.length;d++)parseInt(c[d].getAttribute("productId"),10)===parseInt(a,10)&&(c[d].className="add-recommond")}},popDoAddToStore:function(a,b){},showUsageDropDownList:function(a){var b=document.querySelector("#"+a);b.style.display="block"},changeUsage:function(a,b){var c=document.querySelector("#"+b);c.innerHTML=a.target.innerHTML,a.currentTarget.style.display="none"},cancelDoRecommendCallback:function(){this.hidePopWindow()},confirmDoRecommendCallback:function(){var a,b;if(this.recommendList.length<=0)return this.hidePopWindow(),!1;if(a=document.querySelector("#savePrescriptionName"),b=document.querySelector("#prescriptionName"),"1"===a.value){if(""===b.value||!b.value.isNormalText(2,10))return this.messageBox.show({msg:"请输入正确的处方单名",type:"alert",autoClose:!0}),!1;this.savePrescription(b.value)}else this.sendRecommendDataToChat()},savePrescription:function(a){for(var b=[],c={sendParameters:{name:a}},d=0;d<this.recommendList.length;d++)b.push(this.recommendList[d].productId);c.sendParameters.medicationIds=b.join(","),c.url=this.requestUrl+"doc/medication_quick_add",c.type="GET",c.asyn=!0,c.onSuccess=this.handleSavePrescriptionSuccess.bind(this),c.onError=this.mainPageObj.handleGetError.bind(this),this.ajax.send(c),this.mainPageObj.showLoading()},handleSavePrescriptionSuccess:function(a){0===a.code||"0"===a.code?this.sendRecommendDataToChat():this.mainPageObj.handleGetError(a)},sendRecommendDataToChat:function(){var a=JSON.stringify(this.recommendList);window.localStorage.setItem("recommondData",encodeURIComponent(a)),window.location.href=this.requestUrl+"static/templates/chat/chat.html",this.hidePopWindow()},changeRecommendButtonStatus:function(){var a=this.recommendList,b=document.querySelector("#recommandMedical"),c="recommand-but";a.length>0&&(c+=" actived"),b.className=c},showPopWindow:function(a){this.popWindow.show(a),this.frozenBackWindowOrNot(!0)},hidePopWindow:function(){this.popWindow.hide(),this.frozenBackWindowOrNot(!1)},frozenBackWindowOrNot:function(a){var b=document.querySelector("#searchListScroll"),c=document.querySelector("#prescriptionScroll");b&&(b.style.overflow=a===!0?"hidden":"scroll"),c&&(c.style.overflow=a===!0?"hidden":"scroll")},attachEvent:function(){}},mock_result={data:[{result:[{id:1107,name:"【999】三九感冒灵胶囊 12粒",commonName:"感冒灵胶囊",spec:"6g装",usage:"口服，一次2粒，一日3次。",image:"http://img.jxdyf.com/product/0000/011/11632_L1.jpg",salePrice:"10.90",marketPrice:"13.08",manufacturer:"天津金耀",addNum:0,added:!1,skus:[{skuId:15511,name:"999感冒灵胶囊",salePrice:"10.90",prescribed:!1}],prescribed:!1}],totalCount:1,totalPages:3,pageNo:1}],msg:"success",code:0},mock_return={data:["搜索药品1","搜索药品2","搜索药品1搜索药品1搜索药品1"],msg:"success",code:0},medicalSearch={ajax:null,popWindow:null,messageBox:null,slideTab:null,searchFromDatabase:null,requestUrl:SYS_VAR.SERVER_ADDRESS,doctorId:getQueryString("doctor_id"),patientId:getQueryString("patient_id"),patientName:decodeURIComponent(getQueryString("patient_name")||""),scrollPage:0,key:"",page:1,totalPages:0,num:20,orderBy:"default",order:0,isFirstLoad:!0,isPrescriptionLoaded:!1,currentTabPage:0,init:function(){this.ajax=new Ajax,this.messageBox=new MessageBox,this.popWindow=new PopWindow,this.slideTab=new SlideTabs,this.searchFromDatabase=new SearchFromDatabase,this.slideTab.init({trigger:document.querySelector("#tabControl"),responser:document.querySelectorAll(".tab-con"),selectedCss:"selected",callBack:this.tabClickCallBack.bind(this)}),this.searchFromDatabase.init({ajax:this.ajax,tipList:{action:this.requestUrl+"doc/search_list/"},callback:this.handleDoSearch.bind(this),messageBox:this.messageBox,beforeSearchFunction:this.resetPageInfo.bind(this),pageObj:medicalSearch,pageObjString:"medicalSearch",searchObjString:"searchFromDatabase",bindObj:document.querySelector("#searchBinObj"),tipText:"搜索"}),recommend.init({pageObj:medicalSearch}),favoriteMedicine.init({pageObj:medicalSearch}),this.attachEvent()},handleDoSearch:function(a){if(this.key=a||this.searchFromDatabase.key,!this.key||""===this.key.trim())return this.messageBox.show({msg:"请输入搜索关键字",type:"alert",autoClose:!0}),!1;var b={sendParameters:{doctorId:this.doctorId,key:this.key,page:this.page,num:this.num,orderBy:this.orderBy,order:this.order}};b.url=this.requestUrl+"doc/search_medication/",b.type="GET",b.asyn=!0,b.onSuccess=this.handleGetPatientMedicalSuccess.bind(this),b.onError=this.handleGetError.bind(this),this.showLoading(),this.ajax.send(b),this.isFirstLoad=!1},handleGetPatientMedicalSuccess:function(a){var b,c,d=document.querySelector("#medicalSearchList"),e=document.querySelector("#searchListScroll");if(0===a.code){if(this.hideLoading(),a.data&&a.data.length>0){if(b=a.data[0].result,0===b.length)return this.handleGetError({msg:"没有找到您要想的药品~"}),!1;if(this.totalPages=a.data[0].totalPages,c=this.getListHtml(b,1),1===this.page)d.innerHTML=c;else{var f=document.createElement("span");f.innerHTML=c,d.appendChild(f)}1===this.page&&setTimeout(function(){e.scrollTop=0,e.onscroll=function(a){this.handleScroll(a)}.bind(this)}.bind(this),0)}else this.handleGetError({msg:"没有找到您要想的药品~"});document.querySelector("#mySearchResult").click()}else this.handleGetError(a)},getListHtml:function(a,b){for(var c=[],d=0;d<a.length;d++){var e,f,g,h="添加到常用药",i="add-store",j=a[d].skus[0].skuId,k=[];1==a[d].added&&(h="已经添加",i="add-store add-store-success"),f=a[d].name&&""!==a[d].name&&"null"!==a[d].name&&"undefined"!==a[d].name?a[d].name:"药品",a[d].commonName&&""!==a[d].commonName&&"null"!==a[d].commonName&&"undefined"!==a[d].commonName&&(f+="（"+a[d].commonName+"）"),e=recommend.checkHasAddedRecommend(a[d].id),g='onclick="medicalSearch.handleSearchListClick(event);"',k.push("<span "+e),k.push(' hasAddToStore="0" productId="'+a[d].id+'"'),k.push(' usage="'+encodeURIComponent(a[d].usage||"")+'"'),k.push(' spec="'+encodeURIComponent(a[d].spec||"")+'"'),k.push(' skuId="'+j+'"'),k.push(' productSize="'+encodeURIComponent(a[d].usage||"")+'"'),k.push(' productName="'+encodeURIComponent(a[d].name||"")+'"'),k.push(' commonName="'+encodeURIComponent(a[d].commonName||"")+'"></span>'),c.push('<li class="item" '+g+">"),c.push('<a href="medical-detail.html?medicalId='+a[d].id+"&isAdded="+(a[d].added||!0)+'">'),c.push('<img class="img" src="'+a[d].image+'?s=t" width="100" />'),c.push("</a>"),c.push("<div>"),c.push('<h3 class="tit">'+f+"</h3>"),c.push('<p class="desc">'+(a[d].manufacturer||a[d].usage)+"</p>"),c.push('<p class="desc price">¥'+a[d].salePrice+"</p>"),c.push("</div>"),c.push(k.join("")),c.push("</li>")}return c.join("")},handleGetError:function(a){var b=a.msg;a.msg&&""!==a.msg||(b="网络异常，请稍后再试"),this.messageBox.show({msg:b,type:"alert",autoClose:!0})},handleSearchListClick:function(a){var b,c=a.target,d=c.tagName.toLowerCase();"add-store"===c.className&&(favoriteMedicine.handleAddOrRemoveStore(c.getAttribute("data-id"),c,!0),a.preventDefault(),a.stopPropagation()),"a"!==d&&"dt"!==d&&"img"!==d&&(b=a.currentTarget.querySelectorAll(".add-recommond")[0],recommend.showRecommendBox(b),a.preventDefault(),a.stopPropagation())},handleFilterBar:function(a){var b=a.target;if(!(b.className.indexOf("selected")>=0)){for(var c=b.parentNode.querySelectorAll("li"),d=0;d<c.length;d++)c[d]===b?b.className="selected":c[d].className.indexOf("selected")>=0&&(c[d].className="");this.orderBy=b.getAttribute("type"),this.handleDoSearch(),a.stopPropagation()}},handleFloatFilterBar:function(a){var b=a.currentTarget.querySelector("#filterBarVerticalInner"),c=a.currentTarget.querySelectorAll(".filter-mask")[0],d=a.target,e=d.tagName.toLowerCase();"block"===b.style.display?(b.style.display="none",c.style.display="none"):(b.style.display="block",c.style.display="block"),"li"===e&&this.handleFilterBar(a),a.stopPropagation()},handleScroll:function(){var a=document.querySelector("#searchListScroll");return 0!==this.currentTabPage?!1:this.isFirstLoad===!0?!1:void(a.scrollTop===a.scrollHeight-a.clientHeight&&(this.page++,this.page<=this.totalPages&&this.handleDoSearch()))},resetPageInfo:function(){var a=document.querySelector("#medicalSearchList");a.onscroll=null,this.page=1},tabClickCallBack:function(a){var b=a.getAttribute("for"),c=document.querySelector("#freezePanel");"my-search-list"===b?(this.currentTabPage=0,c.className="need-freeze"):(this.currentTabPage=1,c.className="need-freeze no-need-filter")},openPrescription:function(){favoriteMedicine.getFavoriteMedicine(),this.isPrescriptionLoaded=!0},handleDocumentClick:function(){var a=document.querySelector("#filterBarVerticalInner");"block"===a.style.display&&(a.style.display="none")},showLoading:function(){this.messageBox.show({msg:'<span class="fa fa-spinner fa-pulse fa-2x fa-fw"></span>',type:"loading",autoClose:!1})},hideLoading:function(){this.messageBox.hide()},attachEvent:function(){var a=document.querySelector("#myPrescription"),b=document.querySelector("#filterBar"),c=document.querySelector("#filterBarVertical"),d=document.querySelector("#recommandMedical"),e=document.querySelector("#searchListScroll");a.addEventListener("click",function(){this.openPrescription()}.bind(this)),b.addEventListener("click",function(a){this.resetPageInfo(),this.handleFilterBar(a)}.bind(this)),c.addEventListener("click",function(a){this.resetPageInfo(),this.handleFloatFilterBar(a)}.bind(this)),d.addEventListener("click",function(a){recommend.doRecommend(a)}.bind(this)),window.addEventListener("click",function(a){this.handleDocumentClick(a)}.bind(this)),e.onscroll=function(){this.handleScroll()}.bind(this)}};medicalSearch.init();