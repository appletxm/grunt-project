var mockLatestPatient={code:0,msg:"成功",data:[{id:4,patientIcon:"http://file-www.sioe.cn/201109/14/222211817.jpg",name:"dfd",remarkName:"隔壁小王",gender:null,age:123,createTime:1434680904e3}]},latestPatient={server:SYS_VAR.SERVER_ADDRESS,messageBox:null,ajax:null,doctorId:null,requestUrl:SYS_VAR.SERVER_ADDRESS,init:function(){this.messageBox=new MessageBox,this.ajax=new Ajax,this.doctorId=getQueryString("doctorId"),this.getLatestPatient()},getLatestPatient:function(){var a={sendParameters:{patientIds:""}},b="doc/patient_new_list/",c=this.handleGetInfoSuccess;this.doRequest(b,a,c)},doRequest:function(a,b,c){var d=b;d.url=this.requestUrl+a,d.type="GET",d.asyn=!0,d.onSuccess=c.bind(this),d.onError=this.handleGetError.bind(this),this.showLoading(),this.ajax.send(d)},handleGetInfoSuccess:function(a){0===a.code||"0"===a.code?(this.getLatestPatientHtml(a.data),this.hideLoading()):this.handleGetError(a)},getLatestPatientHtml:function(a){for(var b=[],c=document.querySelector("#patientList"),d=0;d<a.length;d++){var e="../patient-info/patient-info.html",f=1==a[d].gender?"男":"女",g=a[d].age||"无";e+="?patient_id="+encodeURIComponent(a[d].id),e+="&patient_name="+encodeURIComponent(a[d].remarkName||a[d].name),e+="&patient_icon="+encodeURIComponent(a[d].patientIcon),e+="&doctor_id="+encodeURIComponent(this.doctorId),g&&""!==g&&"null"!==g&&"undefined"!==g?g+="岁":g="",b.push('<a class="latest" href="'+e+'">'),b.push("<dl>"),b.push('<dt><img src="'+a[d].patientIcon+'" width="50" height="50" /></dt>'),b.push("<dd>"),b.push("<b>"+(a[d].remarkName||a[d].name)+"</b>"),b.push("<i>"+f+" "+g+"</i>"),b.push("</dd>"),b.push("</dl>"),b.push("</a>")}c.innerHTML=b.join("")},handleGetError:function(a){var b=a.msg;this.hideLoading(),b&&""!==b||(b="系统异常，请稍后重试。"),this.messageBox.show({msg:b,type:"alert",autoClose:!0})},showPatientInfo:function(a,b,c,d){var e="../patient-info/patient-info.html",f="?patient_id="+a+"&patient_name="+b+"&doctor_id="+d+"&patient_icon="+c;window.location.href=e+f},showLoading:function(){this.messageBox.show({msg:'<span class="fa fa-spinner fa-pulse fa-2x fa-fw"></span>',type:"loading",autoClose:!1})},hideLoading:function(){this.messageBox.hide()},attachEvent:function(){}};latestPatient.init();