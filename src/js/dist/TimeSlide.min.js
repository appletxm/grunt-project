var TimeSlide=function(){this.params={scrollCell:50,scrollBigCell:90,animateTimer:0,animateStep:300,countTimer:0,countStep:10,countNumber:0,countMin:10,hoursObj:null,minutesObj:null,secondsObj:null,pageInfo:{start:{pageY:0},end:{pageY:0},move:{startY:0,endY:0}}},this.isTouching=!1,this.init=function(a){if(a)for(var b in a)this.params[b]=a[b];a.timeFormat?this.getFormat(a.timeFormat):this.getFormat("00:00"),this.buildTimePanel(),setTimeout(function(){this.setDefaultValue(),this.resizeTimePanel(),this.attacheEvent()}.bind(this),0)},this.getFormat=function(a){var b=a.split(":");this.currentTime={},/^\d+$/.test(b[0])&&(this.currentTime.hours=parseInt(b[0],10)),/^\d+$/.test(b[1])&&(this.currentTime.minutes=parseInt(b[1],10)),/^\d+$/.test(b[2])&&(this.currentTime.seconds=parseInt(b[2],10))},this.buildTimePanel=function(){var a=this.params,b=this.currentTime,c=[],d=[],e=[],f=0;"number"===(typeof b.hours).toLowerCase()&&(c=this.getTimeHtml(24,"hours"),f+=a.width),"number"===(typeof b.minutes).toLowerCase()&&(d=this.getTimeHtml(60,"minutes",this.params.timeStep),f+=a.width),"number"===(typeof b.seconds).toLowerCase()&&(e=this.getTimeHtml(60,"seconds",this.params.timeStep),f+=a.width),a.triggerTouchObj.innerHTML=this.getGapHtml()+c.join("")+d.join("")+e.join(""),a.triggerTouchObj.style.width=f+"px"},this.getGapHtml=function(){var a=[],b=Math.floor(this.params.showTimeSize/2)*this.params.scrollCell+"px";return a.push('<div class="slide-gap" style="top:'+b+';">'),a.push("<span>:</span>"),"number"===(typeof this.currentTime.seconds).toLowerCase()&&a.push("<span>:</span>"),a.push("</div>"),a.join("")},this.getTimeHtml=function(a,b,c){var d=[],e='<div class="time-slider-outer" for="'+(b||"")+'"><ul for="'+(b||"")+'">',f='</ul><div class="time-mask-top" for="'+(b||"")+'"></div><div class="time-mask-foot" for="'+(b||"")+'"></div></div>';d.push(e),d.push("<li></li>"),this.params.showTimeSize&&this.params.showTimeSize>3&&d.push("<li></li>");for(var g=0;a>g;g++){var h=g%(c||1);(0===h||g===a-1)&&d.push('<li for="'+(b||"")+'">'+(10>g?"0"+g:g)+"</li>")}return d.push("<li></li>"),d.push(f),d},this.setDefaultValue=function(){for(var a,b=this.currentTime,c=this.params.triggerTouchObj.querySelectorAll(".time-slider-outer"),d=0;d<c.length;d++)a=c[d].getAttribute("for"),a&&(this.params[a+"Obj"]=c[d].querySelectorAll("ul")[0]);if("number"===(typeof b.hours).toLowerCase()&&this.doScroll(this.params.hoursObj,parseInt(b.hours,10)),"number"===(typeof b.minutes).toLowerCase()){var e=Math.ceil(parseInt(b.minutes,10)/this.params.timeStep);this.doScroll(this.params.minutesObj,e)}if("number"===(typeof b.seconds).toLowerCase()){var f=Math.ceil(parseInt(b.seconds,10)/this.params.timeStep);this.doScroll(this.params.secondsObj,f)}this.setShowValue()},this.doScroll=function(a,b){0>b&&(b=0),a.style.top="-"+b*this.params.scrollCell+"px"},this.setShowValue=function(){var a=this.currentTime,b="";"number"===(typeof a.hours).toLowerCase()&&(b+=a.hours<10?"0"+a.hours:a.hours),"number"===(typeof a.minutes).toLowerCase()&&(b+=":",b+=a.minutes<10?"0"+a.minutes:a.minutes),"number"===(typeof a.seconds).toLowerCase()&&(b+=":",b+=a.seconds<10?"0"+a.seconds:a.seconds),this.params.showTimeObj&&(this.params.showTimeObj.innerHTML=b)},this.handleTouchStar=function(a){var b=this.params.pageInfo;b.start.pageY=a.pageY||a.touches[0].pageY,b.move.startY=b.start.pageY,this.params.countTimer=setInterval(function(){this.params.countNumber++}.bind(this),this.params.countStep),this.isTouching=!0,a.preventDefault(),a.stopPropagation()},this.handleTouchMove=function(a){var b=this.params.pageInfo;b.end.pageY=a.pageY||a.touches[0].pageY,this.isTouching&&(b.move.startY=b.move.endY,b.move.endY=b.end.pageY),a.preventDefault(),a.stopPropagation()},this.handleTouchEnd=function(a){var b,c=null;clearInterval(this.params.countTimer),b=a.target.getAttribute("for"),b&&(c=this.params[b+"Obj"],c&&(this.isTouching===!0?this.handleScroll(c,b):this.handleScroll(c,b))),a.preventDefault(),a.stopPropagation()},this.handleScroll=function(a,b){var c,d,e=this.params.pageInfo,f=e.end.pageY-e.start.pageY,g=!1,h=0;c=this.currentTime[b],"hours"===b&&(h=23,d=1),("minutes"===b||"seconds"===b)&&(h=59,d=this.params.timeStep),this.params.countNumber<this.params.countMin&&(g=!0),"minutes"!==b&&"seconds"!==b||c!==h||(c=h+1),0>f?c+=g?this.params.fastSkip*d:d:f>0&&(c-=g?this.params.fastSkip*d:d),c>=h&&(c=h),0>=c&&(c=0),this.currentTime[b]=c,this.doScroll(a,Math.ceil(c/d)),this.setShowValue(),this.clearAfterScroll()},this.clearAfterScroll=function(){this.params.pageInfo={start:{pageY:0},end:{pageY:0},move:{startY:0,endY:0}},this.params.countNumber=0,this.isTouching=!1},this.resizeTimePanel=function(){var a,b,c,d,e,f,g=this.params;if(g.showTimeSize>3){c=g.scrollCell*g.showTimeSize,d=Math.floor(g.showTimeSize/2)*g.scrollCell,a=this.params.triggerTouchObj,b=a.querySelectorAll(".time-slider-outer"),e=a.querySelectorAll(".time-mask-top"),f=a.querySelectorAll(".time-mask-foot"),a.style.height=c+"px";for(var h=0;h<b.length;h++)b[h].style.height=c+"px",e[h].style.height=d+"px",f[h].style.height=d+"px"}},this.resetTimePanel=function(a){if(a||(a={},this.params.hoursObj&&(a.hours=0),this.params.minutesObj&&(a.minutes=0),this.params.secondsObj&&(a.seconds=0)),this.params.hoursObj&&(this.currentTime.hours=0,this.doScroll(this.params.hoursObj,parseInt(a.hours,10))),this.params.minutesObj){var b=Math.ceil(parseInt(a.minutes,10)/this.params.timeStep);this.doScroll(this.params.minutesObj,b),this.currentTime.minutes=0}if(this.params.secondsObj){var c=Math.ceil(parseInt(a.seconds,10)/this.params.timeStep);this.doScroll(this.params.secondsObj,c),this.currentTime.seconds=0}},this.attacheEvent=function(){var a=this.params.triggerTouchObj;a.addEventListener("touchstart",function(a){this.handleTouchStar(a)}.bind(this)),a.addEventListener("touchmove",function(a){this.handleTouchMove(a)}.bind(this)),a.addEventListener("touchend",function(a){this.handleTouchEnd(a)}.bind(this))}};