"use strict";var myTime={serverAddress:SYS_VAR.SERVER_ADDRESS,ajax:null,messageBox:null,popWindow:null,timeSwitchStatus:0,timeSwitcher:null,timeChooser:null,init:function(){this.ajax=new Ajax,this.messageBox=new MessageBox,this.popWindow=new PopWindow,this.getDisturbTime(),this.attachEvent()},getDisturbTime:function(){var a={sendParameters:{}};a.url=this.serverAddress+"doc/get_disturb/",a.type="GET",a.asyn=!0,a.onSuccess=this.hanlderGetStatusSuccess.bind(this),a.onError=this.hanlderGetStatusError.bind(this),a.mssage=this.msessageBox,this.ajax.send(a)},hanlderGetStatusSuccess:function(a){0===a.code||"0"===a.code?a.data?this.showTimeStatus(a.data[0]):this.showTimeStatus():this.hanlderGetStatusError()},showTimeStatus:function(a){a?0===a.beginTime||"0"===a.beginTime||null===a.beginTime||void 0===a.beginTime||""===a.beginTime&&0===a.endTime||"0"===a.endTime||null===a.endTime||void 0===a.endTime||""===a.endTime?(this.toggleTimeSwitch(!1),this.timeSwitchStatus=0):(this.toggleTimeSwitch(!0),this.timeSwitchStatus=1,this.setChooser(a)):(this.setChooser(a),this.toggleTimeSwitch(!1),this.timeSwitchStatus=0)},setChooser:function(a){a?(document.querySelector("#startTime").value=a.beginTime,document.querySelector("#endTime").value=a.endTime):(document.querySelector("#startTime").value="22:00",document.querySelector("#endTime").value="08:00")},hanlderGetStatusError:function(a){this.toggleTimeSwitch(!1)},toggleTimeSwitch:function(a){var b;this.timeSwitcher=document.querySelector("#timeSwitch"),this.timeChooser=document.querySelector("#timeChoose"),b=this.timeSwitcher.querySelectorAll("input")[0],a?(this.timeSwitcher.className="animate-check",this.timeChooser.style.display="block",b.value=1,this.timeSwitchStatus=1):(this.timeSwitcher.className="animate-check close",this.timeChooser.style.display="none",b.value=0,this.timeSwitchStatus=0)},attachEvent:function(){var a=document.querySelector("#myTimepanel"),b=document.querySelector("#save");a.addEventListener("click",function(a){this.handleClick(a)}.bind(this)),b.addEventListener("click",this.doSetTime.bind(this))},handleClick:function(a){var b=a.target,c=b.tagName.toLowerCase();("span"===c||"b"===c)&&this.doToggleTime(),a.preventDefault()},doToggleTime:function(){var a=this.timeSwitcher.querySelectorAll("input")[0];this.timeSwitchStatus=parseInt(a.value,10),this.timeSwitchStatus=1===this.timeSwitchStatus?0:1,a.value=this.timeSwitchStatus,this.toggleTimeSwitch(1===this.timeSwitchStatus)},doSetTime:function(){var a=document.querySelector("#startTime").value?document.querySelector("#startTime").value:0,b=document.querySelector("#endTime").value?document.querySelector("#endTime").value:0,c={sendParameters:{}};c.sendParameters.operate=this.timeSwitchStatus,c.sendParameters.beginTime=a,c.sendParameters.endTime=b,c.url=this.serverAddress+"doc/set_disturb/",c.type="GET",c.asyn=!0,c.onSuccess=this.hanlderSaveTimeSuccess.bind(this),c.onError=this.hanlderSaveTimeError.bind(this),c.mssage=this.msessageBox,1===this.timeSwitchStatus?0!==a&&0!==b?this.ajax.send(c):this.messageBox.show({msg:"请设置完成开始时间和结束时间后保存！",type:"alert",autoClose:!0}):this.ajax.send(c)},hanlderSaveTimeSuccess:function(a){0===a.code||"0"===a.code?(this.messageBox.show({msg:"保存成功",type:"alert",autoClose:!0}),setTimeout(this.closeWindow,500)):this.hanlderSaveTimeError(a)},hanlderSaveTimeError:function(a){this.messageBox.show({msg:a.msg||"保存勿扰时间失败，请重试",type:"alert",autoClose:!0})},closeWindow:function(){WeixinJSBridge.call("closeWindow")}};myTime.init();