var UploadImage=function(a){this.canvas=null,this.param={},this.init=function(a){this.param=a,this.createCanvas()},this.checkImage=function(a,b,c){var d=!1,e=Math.ceil(a[0].size/1024),f=new FileReader;return this.param.fileType.forEach(function(b){a[0].type.indexOf(b)>=0&&(d=!0)}),d?(f.onload=function(){var a=f.result;e>this.param.fileMemory?this.reduceImage(a,b,c):this.setImageURL(a,b,c)}.bind(this),void f.readAsDataURL(a[0])):(this.param.messageBox.show({msg:"请选择正确的图片文件",type:"alert",autoClose:!0}),!1)},this.setImageURL=function(a,b,c){b&&b.setAttribute("src",a),c&&c(a)},this.reduceImage=function(a,b,c){var d=new Image;d.src=a,d.onload=function(){this.setImageToCanvas(d,b,c)}.bind(this)},this.setImageToCanvas=function(a,b,c){var d=this.canvas,e=this.param.fileSize,f=1,g=a.naturalWidth||0,h=a.naturalHeight||0;if(g>e.width&&h>e.height){var i=e.width/g,j=e.height/h;f=Math.min(i,j)}else g>e.width?f=e.width/g:h>e.height&&(f=e.height/h);g=parseInt(f*g,10),h=parseInt(f*h,10),d.setAttribute("width",g),d.setAttribute("height",h);var k=d.getContext("2d");k.drawImage(a,0,0,g,h);var l=d.toDataURL("image/jpeg",this.param.dip);this.setImageURL(l,b,c)},this.createCanvas=function(){this.canvas=document.createElement("canvas")},this.init(a)};